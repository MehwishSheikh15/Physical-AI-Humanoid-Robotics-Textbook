"use strict";(globalThis.webpackChunkai_robotics_book=globalThis.webpackChunkai_robotics_book||[]).push([[5898],{4251:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Module-1-ROS2/week-03-ros2-architecture","title":"Week 3: ROS 2 Architecture and Nodes","description":"Master the fundamentals of ROS 2 graph architecture, nodes, packages, and the core concepts that power modern robotic systems.","source":"@site/docs/Module-1-ROS2/week-03-ros2-architecture.mdx","sourceDirName":"Module-1-ROS2","slug":"/Module-1-ROS2/week-03-ros2-architecture","permalink":"/ai-robotics-book/docs/Module-1-ROS2/week-03-ros2-architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/ai-robotics/ai-robotics-book/tree/main/docs/Module-1-ROS2/week-03-ros2-architecture.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Week 3: ROS 2 Architecture and Nodes","description":"Master the fundamentals of ROS 2 graph architecture, nodes, packages, and the core concepts that power modern robotic systems."},"sidebar":"tutorialSidebar","previous":{"title":"Week 2: Physical AI Landscape","permalink":"/ai-robotics-book/docs/Module-1-ROS2/week-02-physical-ai-landscape"},"next":{"title":"Week 4: ROS 2 Topics and Services","permalink":"/ai-robotics-book/docs/Module-1-ROS2/week-04-ros2-topics-services"}}');var r=s(4848),t=s(8453);const o={sidebar_position:3,title:"Week 3: ROS 2 Architecture and Nodes",description:"Master the fundamentals of ROS 2 graph architecture, nodes, packages, and the core concepts that power modern robotic systems."},a="Week 3: ROS 2 Architecture and Nodes",l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"What is ROS 2?",id:"what-is-ros-2",level:2},{value:"ROS 2 vs Traditional Robotics Software",id:"ros-2-vs-traditional-robotics-software",level:3},{value:"ROS 1 vs ROS 2: Why the Upgrade?",id:"ros-1-vs-ros-2-why-the-upgrade",level:3},{value:"The ROS 2 Graph Architecture",id:"the-ros-2-graph-architecture",level:2},{value:"Nodes: The Building Blocks",id:"nodes-the-building-blocks",level:3},{value:"The Computation Graph",id:"the-computation-graph",level:3},{value:"DDS: The Communication Layer",id:"dds-the-communication-layer",level:3},{value:"Creating Your First ROS 2 Package",id:"creating-your-first-ros-2-package",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Package Structure",id:"package-structure",level:3},{value:"Creating a Package",id:"creating-a-package",level:3},{value:"Understanding package.xml",id:"understanding-packagexml",level:3},{value:"Understanding setup.py",id:"understanding-setuppy",level:3},{value:"Writing Your First Node",id:"writing-your-first-node",level:2},{value:"Code Example: Simple Publisher Node",id:"code-example-simple-publisher-node",level:3},{value:"Building and Running Your Node",id:"building-and-running-your-node",level:3},{value:"ROS 2 Command-Line Tools",id:"ros-2-command-line-tools",level:2},{value:"Introspecting the Graph",id:"introspecting-the-graph",level:3},{value:"Visualizing the Graph",id:"visualizing-the-graph",level:3},{value:"Quality of Service (QoS) Policies",id:"quality-of-service-qos-policies",level:2},{value:"Key QoS Settings",id:"key-qos-settings",level:3},{value:"Code Example: Custom QoS Profile",id:"code-example-custom-qos-profile",level:3},{value:"Node Lifecycle",id:"node-lifecycle",level:2},{value:"Self-Assessment Questions",id:"self-assessment-questions",level:2},{value:"Summary",id:"summary",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"week-3-ros-2-architecture-and-nodes",children:"Week 3: ROS 2 Architecture and Nodes"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsxs)(n.p,{children:["Welcome to the world of ",(0,r.jsx)(n.strong,{children:"ROS 2"})," (Robot Operating System 2)\u2014the middleware that powers countless research and commercial robots worldwide. Think of ROS 2 as the nervous system of your robot: it connects sensors, algorithms, and actuators, enabling them to communicate seamlessly in real-time."]}),"\n",(0,r.jsxs)(n.p,{children:["Unlike traditional monolithic software where everything runs in a single program, ROS 2 embraces a ",(0,r.jsx)(n.strong,{children:"distributed, modular architecture"}),'. Individual components (called "nodes") run as separate processes, communicating over well-defined interfaces. This design enables code reuse, parallel development, and runtime flexibility\u2014you can swap out a camera driver without touching your navigation code.']}),"\n",(0,r.jsx)(n.p,{children:"This week, you'll learn the foundational architecture of ROS 2, understand what nodes are, create your first ROS 2 package, and build a simple publisher-subscriber system. By the end, you'll have hands-on experience with the core building blocks that will support everything from SLAM to VLA systems in later weeks."}),"\n",(0,r.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(n.p,{children:"By the end of this week, you will be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Explain"})," the ROS 2 graph architecture and how nodes communicate"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Differentiate"})," between ROS 1 and ROS 2, understanding why ROS 2 is essential for modern robotics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create"})," a ROS 2 package with proper structure and dependencies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implement"})," a simple ROS 2 node in Python with lifecycle management"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Understand"})," the DDS middleware layer and Quality of Service (QoS) settings"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"what-is-ros-2",children:"What is ROS 2?"}),"\n",(0,r.jsx)(n.h3,{id:"ros-2-vs-traditional-robotics-software",children:"ROS 2 vs Traditional Robotics Software"}),"\n",(0,r.jsx)(n.p,{children:"Imagine building a robot where the camera driver, the path planning algorithm, the motor controller, and the logging system are all tightly coupled in a single executable. Any bug in one component could crash the entire system. Updating one component requires recompiling everything. Testing in isolation is nearly impossible."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)("span",{className:"highlight-purple",children:(0,r.jsx)(n.strong,{children:"ROS 2"})})," solves this by providing:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Modular Architecture"}),": Each component is an independent node"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Standardized Communication"}),": Nodes talk via topics, services, and actions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Language Flexibility"}),": Write nodes in Python, C++, or other supported languages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ecosystem"}),": Thousands of pre-built packages (navigation, manipulation, perception)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tooling"}),": Visualization (RViz), logging (rosbag), introspection (ros2 CLI)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"ROS 2 isn't an operating system\u2014it's middleware that sits between your application code and the OS (typically Ubuntu Linux)."}),"\n",(0,r.jsx)(n.h3,{id:"ros-1-vs-ros-2-why-the-upgrade",children:"ROS 1 vs ROS 2: Why the Upgrade?"}),"\n",(0,r.jsx)(n.p,{children:"ROS 1 (introduced in 2007) served the robotics community well but had fundamental limitations:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Limitation"}),(0,r.jsx)(n.th,{children:"ROS 1"}),(0,r.jsx)(n.th,{children:"ROS 2"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Real-time"})}),(0,r.jsx)(n.td,{children:"Not real-time capable"}),(0,r.jsx)(n.td,{children:"Real-time support via DDS"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Security"})}),(0,r.jsx)(n.td,{children:"No built-in security"}),(0,r.jsx)(n.td,{children:"DDS-Security for encryption/authentication"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Multi-platform"})}),(0,r.jsx)(n.td,{children:"Primarily Linux"}),(0,r.jsx)(n.td,{children:"Linux, Windows, macOS, RTOS"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Communication"})}),(0,r.jsx)(n.td,{children:"Custom TCPROS/UDPROS"}),(0,r.jsx)(n.td,{children:"Industry-standard DDS"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Master Node"})}),(0,r.jsx)(n.td,{children:"Single point of failure (roscore)"}),(0,r.jsx)(n.td,{children:"Fully distributed (no master)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Embedded Systems"})}),(0,r.jsx)(n.td,{children:"Limited support"}),(0,r.jsx)(n.td,{children:"Works on resource-constrained systems"})]})]})]}),"\n",(0,r.jsx)("div",{className:"neon-border",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Why This Matters"}),": ROS 2's real-time capabilities and security make it suitable for commercial products (autonomous vehicles, surgical robots), not just research. The distributed architecture eliminates the single point of failure (no more roscore crashes!)."]})}),"\n",(0,r.jsx)(n.h2,{id:"the-ros-2-graph-architecture",children:"The ROS 2 Graph Architecture"}),"\n",(0,r.jsx)(n.h3,{id:"nodes-the-building-blocks",children:"Nodes: The Building Blocks"}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)("span",{className:"highlight-purple",children:(0,r.jsx)(n.strong,{children:"node"})})," is a single-purpose process that performs a specific computation. Examples:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A node that reads camera data and publishes images"}),"\n",(0,r.jsx)(n.li,{children:"A node that subscribes to images and detects objects"}),"\n",(0,r.jsx)(n.li,{children:"A node that plans paths from current location to goal"}),"\n",(0,r.jsx)(n.li,{children:"A node that sends motor commands to wheel controllers"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Nodes are ",(0,r.jsx)(n.strong,{children:"independent"}),"\u2014each runs in its own process (or can share a process for efficiency). If one node crashes, others continue running."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:'graph TB\n    subgraph "ROS 2 Architecture Layers"\n        App["Application Layer<br/>(Your Nodes)"]\n        RCL["ROS Client Library<br/>(rclpy, rclcpp)"]\n        RMW["ROS Middleware Interface<br/>(rmw)"]\n        DDS["DDS Implementation<br/>(FastDDS, CycloneDDS, RTI)"]\n        OS["Operating System<br/>(Linux, Windows, macOS)"]\n    end\n\n    App --\x3e RCL\n    RCL --\x3e RMW\n    RMW --\x3e DDS\n    DDS --\x3e OS\n\n    style App fill:#a855f7,stroke:#9333ea,stroke-width:2px,color:#fff\n    style RCL fill:#ec4899,stroke:#db2777,stroke-width:2px,color:#fff\n    style DDS fill:#06b6d4,stroke:#0891b2,stroke-width:2px,color:#fff\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Diagram:"})," ROS 2's layered architecture. Your application nodes use client libraries (Python/C++), which communicate through the middleware abstraction layer (rmw) to DDS implementations."]}),"\n",(0,r.jsx)(n.h3,{id:"the-computation-graph",children:"The Computation Graph"}),"\n",(0,r.jsxs)(n.p,{children:["At runtime, ROS 2 creates a ",(0,r.jsx)(n.strong,{children:"computation graph"})," where:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nodes"})," are vertices (independent processes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topics, Services, Actions"})," are edges (communication channels)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Here's a simple example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       /camera/image        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Camera Driver\u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500> \u2502Object Detector\u2502\n\u2502     Node     \u2502       (topic)              \u2502     Node     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                    \u2502\n                                                    \u2502 /detected_objects\n                                                    \u2502 (topic)\n                                                    \u2193\n                                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                            \u2502  Planner     \u2502\n                                            \u2502     Node     \u2502\n                                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This graph is ",(0,r.jsx)(n.strong,{children:"dynamic"}),"\u2014nodes can join or leave at runtime, and you can query the graph to see what's currently running."]}),"\n",(0,r.jsx)(n.h3,{id:"dds-the-communication-layer",children:"DDS: The Communication Layer"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 uses ",(0,r.jsx)("span",{className:"highlight-purple",children:(0,r.jsx)(n.strong,{children:"DDS (Data Distribution Service)"})}),", an industry-standard middleware for real-time distributed systems. DDS provides:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Discovery"}),": Nodes automatically find each other on the network (no central broker)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Quality of Service"}),": Configure reliability, latency, durability per connection"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scalability"}),": Efficient multicast for one-to-many communication"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Interoperability"}),": Different DDS vendors (FastDDS, CycloneDDS, RTI Connext) can interoperate"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"You don't need to understand DDS internals to use ROS 2, but knowing it exists helps when tuning performance or debugging network issues."}),"\n",(0,r.jsx)(n.h2,{id:"creating-your-first-ros-2-package",children:"Creating Your First ROS 2 Package"}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Ensure you have ROS 2 installed (Humble or newer recommended):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Check ROS 2 installation\nsource /opt/ros/humble/setup.bash\nros2 --version  # Should show "ros2 cli version 0.18.x"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"package-structure",children:"Package Structure"}),"\n",(0,r.jsx)(n.p,{children:"A ROS 2 Python package follows this structure:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"my_robot_pkg/\n\u251c\u2500\u2500 package.xml          # Package metadata and dependencies\n\u251c\u2500\u2500 setup.py             # Python package installation script\n\u251c\u2500\u2500 setup.cfg            # Python package configuration\n\u251c\u2500\u2500 resource/            # Resource marker file\n\u2502   \u2514\u2500\u2500 my_robot_pkg\n\u2514\u2500\u2500 my_robot_pkg/        # Python source code directory\n    \u251c\u2500\u2500 __init__.py\n    \u2514\u2500\u2500 my_first_node.py\n"})}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-package",children:"Creating a Package"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Navigate to your ROS 2 workspace source directory\ncd ~/ros2_ws/src\n\n# Create a new Python package\nros2 pkg create --build-type ament_python my_robot_pkg \\\n  --dependencies rclpy std_msgs\n\n# Explanation:\n# --build-type ament_python: Use Python (alternatives: ament_cmake for C++)\n# --dependencies: List packages this package depends on\n#   - rclpy: ROS 2 Python client library\n#   - std_msgs: Standard message types\n"})}),"\n",(0,r.jsx)(n.p,{children:"This command generates the package structure automatically."}),"\n",(0,r.jsx)(n.h3,{id:"understanding-packagexml",children:"Understanding package.xml"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"package.xml"})," file describes your package:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>my_robot_pkg</name>\n  <version>0.0.1</version>\n  <description>My first ROS 2 package</description>\n  <maintainer email="you@example.com">Your Name</maintainer>\n  <license>MIT</license>\n\n  \x3c!-- Build tool dependency --\x3e\n  <buildtool_depend>ament_python</buildtool_depend>\n\n  \x3c!-- Runtime dependencies --\x3e\n  <exec_depend>rclpy</exec_depend>\n  <exec_depend>std_msgs</exec_depend>\n\n  \x3c!-- Test dependencies --\x3e\n  <test_depend>ament_copyright</test_depend>\n  <test_depend>ament_flake8</test_depend>\n  <test_depend>ament_pep257</test_depend>\n  <test_depend>python3-pytest</test_depend>\n\n  <export>\n    <build_type>ament_python</build_type>\n  </export>\n</package>\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Always specify dependencies in ",(0,r.jsx)(n.code,{children:"package.xml"}),". ROS 2's build system (colcon) uses this to determine build order and check for missing dependencies."]})}),"\n",(0,r.jsx)(n.h3,{id:"understanding-setuppy",children:"Understanding setup.py"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"setup.py"})," file tells Python how to install your package:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\n\npackage_name = 'my_robot_pkg'\n\nsetup(\n    name=package_name,\n    version='0.0.1',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='you@example.com',\n    description='My first ROS 2 package',\n    license='MIT',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            # Format: 'executable_name = package_name.module:function'\n            'my_node = my_robot_pkg.my_first_node:main',\n        ],\n    },\n)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"entry_points"})," section is crucial\u2014it defines executable scripts that will be installed to your ROS 2 workspace."]}),"\n",(0,r.jsx)(n.h2,{id:"writing-your-first-node",children:"Writing Your First Node"}),"\n",(0,r.jsx)(n.h3,{id:"code-example-simple-publisher-node",children:"Code Example: Simple Publisher Node"}),"\n",(0,r.jsxs)(n.p,{children:["Create ",(0,r.jsx)(n.code,{children:"my_robot_pkg/my_first_node.py"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n    \"\"\"A simple ROS 2 node that publishes messages\"\"\"\n\n    def __init__(self):\n        # Initialize the node with a name\n        super().__init__('minimal_publisher')\n\n        # Create a publisher\n        # - Message type: String\n        # - Topic name: '/chatter'\n        # - Queue size: 10 (how many messages to buffer)\n        self.publisher_ = self.create_publisher(String, '/chatter', 10)\n\n        # Create a timer that calls the callback every 0.5 seconds\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n        # Counter for message numbering\n        self.counter = 0\n\n        self.get_logger().info('Minimal Publisher Node has been started')\n\n    def timer_callback(self):\n        \"\"\"Called by the timer at regular intervals\"\"\"\n        # Create a message\n        msg = String()\n        msg.data = f'Hello ROS 2! Message #{self.counter}'\n\n        # Publish the message\n        self.publisher_.publish(msg)\n\n        # Log to console\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n\n        # Increment counter\n        self.counter += 1\n\n\ndef main(args=None):\n    # Initialize the ROS 2 Python client library\n    rclpy.init(args=args)\n\n    # Create the node\n    minimal_publisher = MinimalPublisher()\n\n    # Keep the node running (blocking call)\n    # This spins the node, processing callbacks\n    try:\n        rclpy.spin(minimal_publisher)\n    except KeyboardInterrupt:\n        pass\n\n    # Clean up\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"building-and-running-your-node",children:"Building and Running Your Node"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Navigate to workspace root\ncd ~/ros2_ws\n\n# Build the package\ncolcon build --packages-select my_robot_pkg\n\n# Source the workspace (makes your package discoverable)\nsource install/setup.bash\n\n# Run the node\nros2 run my_robot_pkg my_node\n\n# Expected output:\n# [INFO] [minimal_publisher]: Minimal Publisher Node has been started\n# [INFO] [minimal_publisher]: Publishing: "Hello ROS 2! Message #0"\n# [INFO] [minimal_publisher]: Publishing: "Hello ROS 2! Message #1"\n# ...\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["After modifying Python code, you must rebuild with ",(0,r.jsx)(n.code,{children:"colcon build"}),". For faster development, you can build with symlinks: ",(0,r.jsx)(n.code,{children:"colcon build --symlink-install"}),", which allows Python changes without rebuilding (C++ still requires rebuild)."]})}),"\n",(0,r.jsx)(n.h2,{id:"ros-2-command-line-tools",children:"ROS 2 Command-Line Tools"}),"\n",(0,r.jsx)(n.h3,{id:"introspecting-the-graph",children:"Introspecting the Graph"}),"\n",(0,r.jsx)(n.p,{children:"While your node is running (in another terminal):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Source ROS 2 setup\nsource /opt/ros/humble/setup.bash\n\n# List all running nodes\nros2 node list\n# Output: /minimal_publisher\n\n# Get information about a node\nros2 node info /minimal_publisher\n# Shows publishers, subscribers, services, actions\n\n# List all topics\nros2 topic list\n# Output: /chatter, /rosout (logging topic)\n\n# See messages on a topic\nros2 topic echo /chatter\n# Output: Real-time messages as they're published\n\n# Get topic info (publishers, subscribers, message type)\nros2 topic info /chatter\n\n# Measure topic frequency and bandwidth\nros2 topic hz /chatter  # Shows publishing rate (should be ~2 Hz)\nros2 topic bw /chatter  # Shows bandwidth usage\n"})}),"\n",(0,r.jsx)(n.h3,{id:"visualizing-the-graph",children:"Visualizing the Graph"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Install rqt_graph if not already installed\nsudo apt install ros-humble-rqt-graph\n\n# Launch the graph visualization\nrqt_graph\n"})}),"\n",(0,r.jsx)(n.p,{children:"This opens a GUI showing nodes (ovals) and topics (edges) in real-time\u2014incredibly useful for debugging complex systems."}),"\n",(0,r.jsx)(n.h2,{id:"quality-of-service-qos-policies",children:"Quality of Service (QoS) Policies"}),"\n",(0,r.jsxs)(n.p,{children:["DDS allows fine-grained control over communication reliability and performance through ",(0,r.jsx)("span",{className:"highlight-purple",children:(0,r.jsx)(n.strong,{children:"QoS (Quality of Service)"})})," policies."]}),"\n",(0,r.jsx)(n.h3,{id:"key-qos-settings",children:"Key QoS Settings"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Reliability"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reliable"}),": Guaranteed delivery (like TCP) - use for critical data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Best Effort"}),": May drop messages (like UDP) - use for high-frequency sensor data"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Durability"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Volatile"}),": New subscribers don't get old messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Transient Local"}),": New subscribers receive last published message (useful for configuration)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"History"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep Last (N)"}),": Store only last N messages in queue"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep All"}),": Store all messages (until queue fills)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Deadline"}),": Expected maximum time between messages"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Lifespan"}),": How long messages remain valid"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"code-example-custom-qos-profile",children:"Code Example: Custom QoS Profile"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy\n\n# Create a QoS profile for sensor data (best effort, keep last 10)\nsensor_qos = QoSProfile(\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n    durability=DurabilityPolicy.VOLATILE,\n    history=HistoryPolicy.KEEP_LAST,\n    depth=10\n)\n\n# Use the custom QoS when creating a publisher\nself.publisher_ = self.create_publisher(\n    String,\n    '/sensor_data',\n    sensor_qos  # Apply custom QoS\n)\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"QoS policies must be compatible between publishers and subscribers. For example, a Reliable publisher cannot communicate with a Best Effort subscriber unless you explicitly configure compatibility."})}),"\n",(0,r.jsx)(n.h2,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,r.jsxs)(n.p,{children:["ROS 2 supports ",(0,r.jsx)(n.strong,{children:"managed nodes"})," with explicit lifecycle states:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Unconfigured \u2192 Inactive \u2192 Active \u2192 Finalized\n      \u2191            \u2193         \u2193\n      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Unconfigured"}),": Node exists but not initialized"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Inactive"}),": Configured but not processing data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Active"}),": Fully operational"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Finalized"}),": Cleaned up and ready to destroy"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This is useful for nodes that require multi-stage initialization (e.g., load config \u2192 allocate resources \u2192 start processing)."}),"\n",(0,r.jsx)(n.h2,{id:"self-assessment-questions",children:"Self-Assessment Questions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What is the primary advantage of ROS 2's distributed architecture compared to a monolithic program?"})}),"\n",(0,r.jsx)(s,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Answer"}),"\nROS 2's distributed architecture allows independent nodes to run as separate processes, enabling modularity, fault isolation, code reuse, and parallel development. If one node crashes, other nodes continue running (fault isolation). Developers can work on different nodes simultaneously without conflicts. Pre-built nodes (e.g., camera drivers) can be reused across projects without modification. You can also test individual nodes in isolation, making debugging easier than in a monolithic system where all components are tightly coupled."]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Explain the difference between Reliable and Best Effort QoS policies, and provide an example of when to use each."})}),"\n",(0,r.jsx)(s,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Answer"}),"\n",(0,r.jsx)(n.strong,{children:"Reliable"}),": Guarantees message delivery (like TCP), retransmitting if packets are lost. Use for critical data where missing messages would cause failures\u2014e.g., goal commands for navigation, safety stop signals, configuration parameters.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.strong,{children:"Best Effort"}),": Does not guarantee delivery (like UDP), prioritizing low latency over reliability. Use for high-frequency sensor data where occasional dropped messages are acceptable\u2014e.g., camera images at 30 FPS, LIDAR scans, IMU data. Missing one frame out of 30 usually doesn't impact performance, and retransmitting would introduce latency."]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why does ROS 2 use DDS instead of creating its own communication protocol?"})}),"\n",(0,r.jsx)(s,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Answer"}),"\nDDS (Data Distribution Service) is an industry-standard middleware that's been battle-tested in aerospace, defense, and industrial automation for decades. By adopting DDS, ROS 2 gains: (1) Real-time performance with deterministic latency, (2) Built-in security (DDS-Security), (3) Interoperability with non-ROS systems, (4) Vendor choice (multiple DDS implementations available), (5) Automatic discovery without a central broker, (6) Quality of Service fine-tuning. Creating a custom protocol would require years of development and wouldn't match DDS's maturity."]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["What is the purpose of the ",(0,r.jsx)(n.code,{children:"rclpy.spin()"})," function in a ROS 2 node?"]})}),"\n",(0,r.jsx)(s,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Answer"}),"\n",(0,r.jsx)(n.code,{children:"rclpy.spin()"})," is a blocking call that keeps the node alive and processes callbacks (timers, subscriptions, services, actions). Without spin, the node would execute the ",(0,r.jsx)(n.code,{children:"main()"})," function and immediately exit. Spin continuously checks for incoming messages, timer expirations, and service requests, then calls the appropriate callback functions (e.g., ",(0,r.jsx)(n.code,{children:"timer_callback()"})," when a timer fires). It essentially implements the event loop that makes the node responsive to external events."]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How would you find out what topics a running node is publishing, without looking at the source code?"})}),"\n",(0,r.jsx)(s,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Answer"}),"\nUse the ROS 2 command-line introspection tools:",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.code,{children:"ros2 node info /node_name"})," - Shows all publishers, subscribers, services, and actions for that node",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.code,{children:"ros2 topic list"})," - Lists all active topics (though doesn't show which node publishes each)",(0,r.jsx)("br",{}),"\n",(0,r.jsx)(n.code,{children:"rqt_graph"})," - Visualizes the graph showing nodes and topics with directional arrows",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"\nYou can also echo messages from a topic to verify it's publishing: ",(0,r.jsx)(n.code,{children:"ros2 topic echo /topic_name"})]})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"This week, you've learned the foundational architecture of ROS 2:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ROS 2"})," is middleware that enables modular, distributed robotic systems"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nodes"})," are independent processes that communicate via DDS"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Packages"})," organize code with metadata (package.xml) and installation scripts (setup.py)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"QoS policies"})," allow fine-tuned control over communication reliability and performance"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Command-line tools"})," (",(0,r.jsx)(n.code,{children:"ros2 node"}),", ",(0,r.jsx)(n.code,{children:"ros2 topic"}),", ",(0,r.jsx)(n.code,{children:"rqt_graph"}),") enable runtime introspection"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.p,{children:["In Week 4, we'll dive into ",(0,r.jsx)(n.strong,{children:"ROS 2 Topics and Services"}),", exploring how nodes exchange data through publish-subscribe patterns (topics) and request-reply patterns (services). You'll build a subscriber node to receive messages and create your first service for on-demand computation."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);